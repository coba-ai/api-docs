export const metadata = {
  title: 'Transactions',
  description:
    'Create and manage financial transactions using the Coba API',
}

# Transactions

Transactions are a core part of the Coba API — they represent the movement of funds between accounts, whether for internal transfers or external payouts. On this page, you’ll find everything you need to create and manage transactions programmatically. {{ className: 'lead' }}

## The transaction model

The transaction model contains all the information about a financial transfer initiated through the Coba API. 
It includes details such as the amount, usd_amount, account_number, account_holder, kind, description, created_at, status, token, provider_transaction_id.
Transactions can represent internal movements, outbound payments, or FX-converted transfers.

Each transaction is immutable once created, but its status will update as it moves through the processing lifecycle — from pending to completed, declined, or refunded. This model provides a complete snapshot of every transfer your application initiates.

### Properties

<Properties>
  <Property name="amount" type="string">
    The original amount of the transaction, in MXN.
  </Property>
  <Property name="usd_amount" type="string">
    The amount in USD equivalent to the original amount.
  </Property>
  <Property name="account_number" type="string">
    The destination account number receiving the funds.
  </Property>
  <Property name="account_holder" type="string">
    The name of the account holder receiving the funds.
  </Property>
  <Property name="kind" type="string">
    The type of transaction. For example, <code>spei</code> for transfers in Mexico.
  </Property>
  <Property name="description" type="string">
    A custom description provided by the client to identify the transaction.
  </Property>
  <Property name="created_at" type="timestamp">
    Timestamp of when the transaction was created with timezone.
  </Property>
  <Property name="status" type="string">
    Current status of the transaction.  
    One of: <code>pending</code>, <code>complete</code>, <code>refunded</code>, <code>declined</code>.
  </Property>
  <Property name="token" type="string">
    A unique, signed identifier for this transaction. Use this to reference the transaction in client-side or follow-up operations.
  </Property>
  <Property name="provider_transaction_id" type="string">
    An optional ID returned by the underlying provider that executed the transaction.  
    Useful for reconciliation or support cases.
  </Property>
</Properties>

---

## List all transactions {{ tag: 'GET', label: '/transactions' }}

<Row>
  <Col>

    This endpoint allows you to retrieve a paginated list of all your transactions. By default, a maximum of ten transactions are shown per page.

    ### Optional attributes

    <Properties>
      <Property name="per_page" type="integer">
        Limit the number of transactions returned.
      </Property>
      <Property name="page" type="string">
        The page number to retrieve.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="GET" label="/transactions">

    ```bash {{ title: 'cURL' }}
    curl -G https://sandbox.api.coba.ai/metal/transactions \
      -H "Authorization: Bearer {token}" \
      -H "X-Coba-Metal-API-Key: {client_api_key}" 
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "data": [
          {
              "amount": "20.0",
              "usd_amount": "1.0",
              "account_number": "000000000000000000",
              "account_holder": "John Doe",
              "kind": "spei",
              "description": "Some description for sandbox",
              "created_at": "2025-05-23T18:03:52.760Z",
              "status": "pending",
              "token": "oIJKrpVKml-BVq8N5JGm6g8VjsrR8sPhvJZRty02-8mmzxtcGuvT6paWqymj-Zoc1R9gL4p6L8vqnJ8XIBFbFw",
              "provider_transaction_id": null
          }
      ],
      "metadata": {
          "prev_url": "/metal/transactions?per_page=1&page=",
          "next_url": "/metal/transactions?per_page=1&page=2",
          "count": 3,
          "page": 1,
          "next": 2
      }
    }
    ```

  </Col>
</Row>

---

## Create a SPEI {{ tag: 'POST', label: '/transactions' }}

This endpoint allows you to create a SPEI transaction. 

<Row>
  <Col>

    This endpoint allows you to add a new conversation between you and a contact or group. A contact or group id is required to create a conversation.

    ### Required attributes

    <Properties>
      <Property name="amount" type="string">
        Unique identifier for the other contact in the conversation.
      </Property>
      <Property name="usd_amount" type="string">
        Unique identifier for the group that the conversation belongs to.
      </Property>
      <Property name="account_number" type="string">
        Unique identifier for the group that the conversation belongs to.
      </Property>
      <Property name="account_holder" type="string">
        Unique identifier for the group that the conversation belongs to.
      </Property>
      <Property name="kind" type="string">
        Unique identifier for the group that the conversation belongs to.
      </Property>
      <Property name="description" type="string">
        Unique identifier for the group that the conversation belongs to.
      </Property>
    </Properties>

  </Col>
  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/v1/conversations">

    ```bash {{ title: 'cURL' }}
    curl https://api.protocol.chat/v1/conversations \
      -H "Authorization: Bearer {token}" \
      -d 'contact_id'="WAz8eIbvDR60rouK"
    ```

    ```js
    import ApiClient from '@example/protocol-api'

    const client = new ApiClient(token)

    await client.conversations.create({
      contact_id: 'WAz8eIbvDR60rouK',
    })
    ```

    ```python
    from protocol_api import ApiClient

    client = ApiClient(token)

    client.conversations.create(contact_id="WAz8eIbvDR60rouK")
    ```

    ```php
    $client = new \Protocol\ApiClient($token);

    $client->conversations->create([
      'contact_id' => 'WAz8eIbvDR60rouK',
    ]);
    ```

    </CodeGroup>

    ```json {{ title: 'Response' }}
    {
      "id": "xgQQXg3hrtjh7AvZ",
      "contact_id": "WAz8eIbvDR60rouK",
      "group_id": null,
      "pinned_message_id": null,
      "is_pinned": false,
      "is_muted": false,
      "last_active_at": null,
      "last_opened_at": null,
      "created_at": 692233200,
      "archived_at": null
    }
    ```

  </Col>
</Row>