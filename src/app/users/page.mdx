export const metadata = {
  title: 'Users',
  description:
    'Create and manage users using the Coba API',
}

# Users

Users are a core part of the Coba API — they represent the individuals or entities that interact with your application. On this page, you’ll find everything you need to create and manage users programmatically. {{ className: 'lead' }}

## The user model

The user model contains all the information about a user registered through the Coba API.
It includes details such as the name, email, phone number, and status. Users can be individuals or businesses.

Each user is immutable once created, but their status can change based on interactions with your application.

### Properties

  <Properties>
    <Property name="id" type="string">
      The unique identifier of the user.
      Sample: <code>68811830bb6e5d659501e1e8</code>
    </Property>

    <Property name="status" type="string">
      The current onboarding status for the user: <code>['onboarding', 'review', 'approved']</code>
    </Property>
  </Properties>

---

## 1. Create a user {{ tag: 'POST', label: '/users' }}

<Row>
  <Col>
    This endpoint allows you to create a new user.

    ### Required attributes
      <Properties>
        <Property name="country" type="string">
          The country of the user.
          One of: <code>MX</code>, <code>PE</code>
        </Property>
        <Property name="email" type="string">
          The email address of the user.
        </Property>
        <Property name="phone_number" type="string">
          The phone number of the user, including country code.
          Sample: <code>+528111235654</code>
        </Property>
        <Property name="user_type" type="enum<string>">
          The type of user being created.
          One of: <code>individual</code> or <code>business</code>.
        </Property>
        <Property name="address" type="object">
          The address of the user.
          <Property name="address.street1" type="string">
            The street address of the user.
          </Property>
          <Property name="address.city" type="string">
            The city of the user.
          </Property>
          <Property name="address.state" type="string">
            The state of the user.
          </Property>
          <Property name="address.postal_code" type="string">
            The ZIP code of the user.
          </Property>
          <Property name="address.country" type="string">
            The country of the user.
          </Property>
          <Property name="address.street2" type="string">
            Secondary street address of the user, if applicable.
          </Property>
        </Property>
        <Property name="first_name" type="string">
          The first name of the user. Required for individual type users.
        </Property>
        <Property name="middle_name" type="string">
          The middle name of the user.
        </Property>
        <Property name="last_name" type="string">
          The last name of the user. Required for individual type users.
        </Property>
        <Property name="second_last_name" type="string">
          The second last name of the user.
        </Property>
        <Property name="business_name" type="string">
          The name of the buiness. Required for business type users.
        </Property>
        <Property name="additional_information" type="enum<string>">
          Additional information about the user, such as their tax ID or business registration number.
          <Property name="additional_information.taxpayer_id" type="string">
            The tax ID of the user, if applicable.
          </Property>
          <Property name="additional_information.curp" type="string">
            The CURP of the user, if applicable.
          </Property>
          <Property name="additional_information.date_of_incorporation" type="string">
            This is the date when the entity was officially registered with the country's tax authority. It’s  the date the company was legally formed and registered for tax purposes.
          </Property>
          <Property name="additional_information.expected_monthly_transactional_volume" type="string">
            Estimated Monthly Transaction Volume
          </Property>
          <Property name="additional_information.platform_usage_reason" type="string">
            A detailed description of the reason for using the platform, including the nature of the business activities and how the platform will be used.

            For users of type <code>individual</code>, the client application must display the following declaration to the user and require explicit acceptance. Once accepted, the exact text below must be sent as the value of <code>platform_usage_reason</code>:

            <i>
            <b>Declaro</b> que el motivo de mi relación comercial con la plataforma es <b>únicamente</b> realizar operaciones de <b>on-ramp y off-ramp de stablecoins</b>. Asimismo, <b>declaro</b> que los fondos que serán operados a través de la plataforma <b>provienen exclusivamente de mi actividad económica lícita</b>, y que <b>yo soy el beneficiario final (UBO)</b> de dichas transacciones y de los recursos involucrados, <b>sin actuar en nombre ni por cuenta de terceros.</b>
            </i>

          </Property>
          <Property name="additional_information.source_of_funds" type="string">
            A description of the origin and nature of the funds that will be operated through the platform.
          </Property>
        </Property>
      </Properties>
  </Col>

  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/users">

    ```bash {{ title: 'cURL' }}
    curl -X POST https://sandbox.api.coba.ai/metal/users \
      -H "Authorization: Bearer {token}" \
      -H "X-Coba-Metal-API-Key: {client_api_key}" \
      -d '{
        "user": {
          "country": "MX",
          "first_name": "John",
          "middle_name": "Michael",
          "last_name": "Doe",
          "second_last_name": "Smith",
          "email": "john.doe@example.com",
          "phone_number": "+528111235654",
          "user_type": "individual",
          "address": {
            "street1": "123 Main St",
            "street2": "Apt 4B",
            "city": "Mexico City",
            "state": "CDMX",
            "postal_code": "64000",
            "country": "MX"
          },
          "additional_information": {
            "taxpayer_id": "ACME12345YR2",
            "curp": "GODE561231HDFRRN04",
            "date_of_incorporation": "2015-01-01",
            "expected_monthly_transactional_volume": "10,000 USD",
            "platform_usage_reason": "Declaro que el motivo de mi relación comercial con la plataforma es únicamente realizar operaciones de on-ramp y off-ramp de stablecoins. Asimismo, declaro que los fondos que serán operados a través de la plataforma provienen exclusivamente de mi actividad económica lícita, y que yo soy el beneficiario final (UBO) de dichas transacciones y de los recursos involucrados, sin actuar en nombre ni por cuenta de terceros.",
            "source_of_funds": "Funds originate from business income, including payments received from customers for goods and services."
          }
        }
      }'
    ```

    </CodeGroup>

    ```json {{ title: 'Successful Response' }}
    {
      "id": "68811830bb6e5d659501e1e8",
      "status": "onboarding"
    }
    ```

  </Col>
</Row>

---

## 2. Add additional information to a user (if necessary) {{ tag: 'POST', label: '/users/:id/additional_information' }}

<Row>
  <Col>
    <p>This endpoint allows you to add additional information to an existing user. This is useful for providing more context about the user, such as their tax ID or business registration number.</p>
    <p>You can call this endpoint after creating a user to provide additional information that may be required for compliance or business purposes.</p>
    <p>Note: the information you provide won't be overwritten. If you need to update any of the additional information, you may need to added with a different key name</p>

    ### Required attributes
      <Properties>
        <Property name="additional_information" type="object">
          Additional information about the user.
        </Property>
      </Properties>
  </Col>

  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/users/:id/additional_information">

    ```bash {{ title: 'cURL' }}
    curl -G https://sandbox.api.coba.ai/metal/users/:id/additional_information \
      -H "Authorization: Bearer {token}" \
      -H "X-Coba-Metal-API-Key: {client_api_key}" \
      -d '{
        "additional_information": {
            "rfc": "ACME12345YR2",
            "curp": "ACME1234567890"
        }
      }' 
    ```

    </CodeGroup>

    ``` {{ title: 'Response' }}
    Status 204 No Content
    ```
  </Col>
 </Row> 

 ---

## 3. Upload Document {{ tag: 'POST', label: '/users/:id/documents' }}

<Row>
  <Col>

    <p>This endpoint allows you to upload a document for an existing user. This is useful for providing more context about the user, such as their tax ID or business registration number.</p>
    <p>You can call this endpoint as many times as needed to upload different documents for the same user.</p>

    ### Required documents for user onboarding
      <li>ID (passport, INE, drivers license, etc)</li>
      <li>Proof of address (issued within the last 3 months)</li>
      <li>Tax Compliance Certificate / Constancia de Situación Fiscal (issued within the last 3 months)</li>
      <li>Documents supporting economic activity (Payroll receipts, invoices or the most recent tax returns)</li>
      <li>Articles of Incorporation / Acta Constitutiva (required only for business users)</li>

    ### Required attributes
      <Properties>
        <Property name="document" type="base64 string">
          Document to upload in base64, including content type (PDF, JPG, PNG).
        </Property>
        <Property name="document_type" type="string">
          The type of document being uploaded.
        </Property>
      </Properties>
  </Col>

  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/users/:id/documents">

    ```bash {{ title: 'cURL' }}
    curl -X POST https://sandbox.api.coba.ai/metal/users/:id/documents \
      -H "Authorization: Bearer {token}" \
      -H "X-Coba-Metal-API-Key: {client_api_key}" \
      -d '{
        "document_type": "id_card",
        "document": "data:image/png;base64,iVBORw0KGgoAAAANSUh..."
      }'
    ```

    </CodeGroup>

    ``` {{ title: 'Response' }}
    Status 204 No Content
    ```
  </Col>
 </Row> 

 ---

## 4. Accept terms and conditions {{ tag: 'POST', label: '/users/:id/terms/accept' }}

<Row>
  <Col>
    <p>This endpoint allows you to accept the terms and conditions for an existing user.</p>
  </Col>

  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/users/:id/terms/accept">

    ```bash {{ title: 'cURL' }}
    curl -X POST https://sandbox.api.coba.ai/metal/users/:id/terms/accept \
      -H "Authorization: Bearer {token}" \
      -H "X-Coba-Metal-API-Key: {client_api_key}" 
    ```

    </CodeGroup>

    ``` {{ title: 'Response' }}
    Status 204 No Content
    ```
  </Col>
 </Row> 

## 5. Request Review {{ tag: 'POST', label: '/users/:id/review' }}

<Row>
  <Col>
    <p>This endpoint allows you to request a review for an existing user.</p>
  </Col>

  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/users/:id/review">

    ```bash {{ title: 'cURL' }}
    curl -X POST https://sandbox.api.coba.ai/metal/users/:id/review \
      -H "Authorization: Bearer {token}" \
      -H "X-Coba-Metal-API-Key: {client_api_key}" 
    ```

    </CodeGroup>

    ``` {{ title: 'Response' }}
    Status 204 No Content
    ```
  </Col>
</Row> 

## 6. Get a user {{ tag: 'GET', label: '/users/:id' }}
<Row>
  <Col>
    <p>This endpoint allows you to get an existing user and it's current onboarding status.</p>
    <Properties>
      <Property name="id" type="string">
        The unique identifier of the user.
        Sample: <code>68811830bb6e5d659501e1e8</code>
      </Property>

      <Property name="status" type="string">
        The current onboarding status for the user: <code>['onboarding', 'review', 'approved']</code>
      </Property>
    </Properties>
  </Col>

  <Col sticky>

    <CodeGroup title="Request" tag="POST" label="/users/:id/review">

    ```bash {{ title: 'cURL' }}
    curl -X GET https://sandbox.api.coba.ai/metal/users/:id \
      -H "Authorization: Bearer {token}" \
      -H "X-Coba-Metal-API-Key: {client_api_key}" 
    ```

    </CodeGroup>

    ```json {{ title: 'Successful Response' }}
    {
      "id": "68811830bb6e5d659501e1e8",
      "status": "approved"
    }
    ```
  </Col>
</Row> 